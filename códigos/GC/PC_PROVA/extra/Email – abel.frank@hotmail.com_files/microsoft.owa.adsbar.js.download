window.scriptsLoaded = window.scriptsLoaded || {}; window.scriptProcessStart = window.scriptProcessStart || {}; window.scriptProcessStart['microsoft.owa.adsbar.js'] = (new Date()).getTime();
Type.registerNamespace("_ab");function AdsbarComponent(){}AdsbarComponent.$$cctor=function(){_a.t.a().a(AdsbarComponent)};AdsbarComponent.prototype={b:function(n,t,i){var r=this;n.b(_y.gg,function(){return new _ab.d(n.a(_g.a),n.a(_j.bb),n.a(_a.cb),n.a(_j.j),n.a(_g.E),n.a(_a.y).b(),n.a(_db.t),n.a(_a.q),n.a(_a.y),n.a(_j.cc.$$(_y.bV)))}).a()},a:function(){return null}};_ab.e=function(){_ab.e.initializeBase(this)};_ab.e.prototype={K:function(n){var t=new _dg.cZ(this.L);n.eE(t,this.I,this.H)},cU:function(n,t,i){t()}};_ab.b=function(n,t,i,r,u,f,e,o,s,h,c){this.H=Function.createDelegate(this,this.bo);this.v=Function.createDelegate(this,this.bh);this.t=Function.createDelegate(this,this.bf);this.u=Function.createDelegate(this,this.bg);this.w=Function.createDelegate(this,this.bi);_ab.b.initializeBase(this);_j.s.b(e,"primaryViewModel");this.y=_ff.l.a();this.b=i;this.j=this.b.a().gj().Enabled&&!u.bH.IsShadowMailbox;this.c=n;this.f=_a.bv.a(n.bH.AdMarket,n.D(),i);this.T=this.f.split("-")[0];this.S=this.f.split("-")[1];this.h=u;this.a=e;this.R=f;this.bm();this.d("AdsInitialized",null,null,null,null,null);this.n=s;this.I=h;this.e=r;this.i=[];this.G=t;this.s=this.b.a().bX().Enabled&&this.b.a().gl().Enabled;this.C=c;this.A=i.a().d().OwaAdBarScript?i.a().d().OwaAdBarScript:"https://r1.res.office365.com/adbar/6.11/adbar.js";this.z=i.a().d().OwaAdBarBaseUrl?i.a().d().OwaAdBarBaseUrl:"https://r1.res.office365.com/adbar/6.11/";this.B=i.a().d().AstScriptUrl?i.a().d().AstScriptUrl:"https://acdn.adnxs.com/ast/ast.js";var l=this;o.a(function(n){l.g=n;l.o=l.Z();var t=l.r();l.d(t?"AdBarNotShown":"AdBarShown",t,null,null,null,null);if(l.o){l.e.b(_a.U,l.w);l.e.b(_a.cC,l.u);l.e.b(_a.ds,l.t);l.e.b(_y.X,l.v);window.apntag&&(apntag.l=!0);l.be()}l.U()})};_ab.b.prototype={c:null,e:null,b:null,h:null,n:null,I:null,a:null,f:null,T:null,S:null,R:null,A:null,z:null,B:null,o:!1,m:!1,p:!1,G:null,g:null,l:!1,i:null,D:!1,E:0,j:!1,s:!1,C:null,y:null,bl:function(n){if(this.m!==n){this.m=n;this.eL("ShowAdBlockMessage","ShowUpsell")}return n},L:function(){return this.a.B()===2},V:function(){return this.a.bi()},x:null,N:function(){return!this.L()&&!this.m&&_y.d.l(this.c,this.h)&&(this.j||this.b.a().gk().Enabled)},W:function(){return this.j?_nbs.a.Tp:_nbs.a.QA},Y:function(){var n=this.j?this.b.a().gj().UpsellUrlFormat:this.b.a().gk().UpsellUrlFormat;n||(n="https://aka.ms/l2?WT.mc_id={1}&ep={0}");return String.format(n,encodeURIComponent(this.h.bH.EncryptedUserPuid),"PROD_OL-Web_InApp_BannerAd_Premium")},X:function(){return new _j.g(this.H,_a.a.cZ)},M:function(){return this.b.a().hy().Enabled&&_a.bv.b(this.b.a().hy().SupportedMarkets,this.f)},d:function(n,t,i,r,u,f){var e=new _a.l;var o=-1;if(this.a.d){o=this.a.d.h(this.E===6);o||(o=this.a.d.b)}e.a("pg",o);e.b("cm",this.f);e.b("r",t);e.b("am",i);e.b("p",r);e.b("ipg",u);e.c("ay",this.M());e.b("uid",f);_ab.b.a[n]=n in _ab.b.a?_ab.b.a[n]+1:1;e.a("c",_ab.b.a[n]);e.a("w",window.innerWidth);e.a("h",window.innerHeight);_a.b.c(_a.a.cZ,n,e.toString(),0)},bj:function(){var n=!1;var t=this.a.d;this.a.br();if(this.a.d&&window.wLive&&window.wLive.adbar){if(!this.D){this.O();n=!0}window.wLive.adbar.resize(this.P())}if(this.a.d!==t){this.eV("AdBottom","ShowUpsell","AdsSmall");this.r();n||this.e.a(_a.U,new _a.U(25))}},r:function(){var n=null;this.o?this.a.a()&&this.a.a().a&&_y.c.a.a()==="Mouse"?n="ModuleNotMail":this.a.d?this.i.length&&(n=this.i[0]):n="WindowTooSmall":n="AdsNotEnabled";var t=!n;t&&this.N()&&this.d(this.j?"AdsShowUpsell":"AdsShowAltUpsell",null,null,null,null,null);this.a.bp(t);return n},be:function(){var n=this,t=this;this.G.g(this.A,function(){if(window.wLive)if(window.wLive.adbar)if(document.getElementById("owaadbar")){n.a.d&&n.O();n.d("AdsLoaded",null,null,null,null,null)}else n.q("MissingDiv");else n.q("BlockedAdBarJS");else n.q("BlockedJS")},function(){t.q("BlockedRequest")})},q:function(n){this.bl(_y.c.a.a()==="Mouse");this.d("AdBlock",n,null,null,null,null)},P:function(){var n={};n.AdSizes=this.a.d.a;n.AdPageGroup=this.a.d.b?_ab.b.b+this.a.d.b:null;n.OverridePG=this.Q()?null:"ROW";n.IsAnYield=this.M();n.externalImpId=this.K();n.AolMarkets=this.b.a().d()?this.b.a().d().AolCountryCodes:null;return n},bb:function(){var n=this.P();n.BaseUrl=this.z;n.Market=this.f;n.ContainerID="owaadbar";n.AstUrl=this.B;n.CallbackEventName="AdCallbackOwa";var t=this;n.Visibility=function(){return t.a.o&&t.p};return n},eJ:function(){this.e.c(_a.U,this.w);this.e.c(_a.cC,this.u);this.e.c(_a.ds,this.t);this.e.c(_y.X,this.v);_a.gd.prototype.eJ.call(this)},K:function(){return window.wLive.adbar.generateUUID?window.wLive.adbar.generateUUID():null},O:function(){this.D=!0;var n=this.bb();if(this.b.a().eN().Enabled){var t=this;_g.J.f(function(t){n.extraConfigString="gdpr="+(_g.J.c?"yes":"no")+";euconsent="+t+";";window.wLive.adbar.init(n)})}else window.wLive.adbar.init(n)},bg:function(n){this.bk(n);this.r()},bf:function(n){n.a&&this.d("AdsBeingCovered",null,null,null,null,null);this.p=n.a},bi:function(n){var t=this;_j.m.a().d(_a.a.cZ,"AdsRefresh",function(){var i=null;t.a.o?t.p?i="AdBarCovered":window.wLive&&window.wLive.adbar?window.wLive.adbar.refresh||(i="NoRefreshFunction"):i="WLiveNotLoaded":i="AdBarHidden";if(i)t.d("AdsNoRefresh",i,null,null,null,null);else{var u=t.K();t.E=n.a;t.d("AdsRefresh",_j.u.c(_a.cO,n.a),null,null,null,u);var r=t.a.d.h(n.a===6);window.wLive.adbar.refresh(_j.u.c(_a.cO,n.a),r?_ab.b.b+r:null,u)}})},Q:function(){return!!this.b.a().d()&&_a.bv.b(this.b.a().d().SupportedMarkets,this.f)},bk:function(n){n.b?Array.remove(this.i,n.a):Array.contains(this.i,n.a)||Array.add(this.i,n.a)},bd:function(n){if(n&&n.ConsumerSubscriptions)for(var t=0;t<n.ConsumerSubscriptions.length;t++){var i=n.ConsumerSubscriptions[t];if(i==="GA-O365HOMEPREM-XX-SUB"){this.l=!0;this.d("AdBar365User",null,null,null,null,null);return!1}}return!1},bn:function(){return _a.bv.c(this.b,this.f,_y.c.a.a(),this.h.bH.IsShadowMailbox)&&!this.b.a().mI().Enabled},bh:function(n){this.r();this.a.d&&this.e.a(_a.U,new _a.U(25))},U:function(){if(this.bc()){var n=new _ab.e;var i=this;n.c(function(t){var r=n.N;var i="";r.Subscriptions&&(i=r.Subscriptions.join(","));_j.e.a(_a.a.C,"fetchUserSubscriptionAction success subscription offerid are: {0}",i)});var t=this;n.b(function(n){_j.e.b(_a.a.C,"fetchUserSubscriptionAction failed for user",t.c.c().bH.UserPuid)});this.n.a(n)}},bc:function(){if(!this.b.a().hB().Enabled||!this.g)return!1;if(this.g.ConsumerSubscriptions)for(var n=0;n<this.g.ConsumerSubscriptions.length;n++){var u=this.g.ConsumerSubscriptions[n];if(u==="GA-O365HOMEPREM-XX-SUB"){var r=_a.d.b(this.g.ConsumerSubscriptionExpireDates[n]);if(r.a(_a.d.a())>0)return!1}}var i=this.b.a().hB().DaysBeforeNextFetch;var t=null;this.g.ConsumerSubscriptionLastFetchDate&&(t=_a.d.b(this.g.ConsumerSubscriptionLastFetchDate));return!i||!t||t.c(i).a(_a.d.get_utcNow())<0},ba:function(){var n=null;this.b.a().d().Enabled?this.bd(this.g)?n="o365User":this.h.bH.IsPremiumConsumerMailbox?n=this.l?"AdPaidUserO365":"AdPaidUser":this.b.a().hu().Enabled||this.Q()?this.c.bH.IsConsumerChild?n="ChildAccount":this.bn()&&(n="NativeAdsOn"):n="NonSupportedMarket":n="mainFlightOff";var t=!n;t||this.d("AdsbarNotEnabled",n,null,null,null,null);return t},Z:function(){var t=!1;var n=this.ba();var e=(32768&this.c.a().v())!=32768;if(n!==e){if(n){var f;(f=this.c.a()).x(f.v()&-32769)}else{var u;(u=this.c.a()).x(u.v()|32768)}t=!0}var o=(1048576&this.c.a().v())!=1048576;if(this.l!==o){if(this.l){var i;(i=this.c.a()).x(i.v()&-1048577)}else{var r;(r=this.c.a()).x(r.v()|1048576)}t=!0}t&&_h.f.a(this.c.a().u,this.n);return n},bm:function(){var t=String.format("http://windows.microsoft.com/{0}/outlook/ad-free-outlook",this.f);if(this.b.a().dr().Enabled&&!this.h.bH.IsShadowMailbox){var n=this.b.a().dr().UpsellUrlFormat;n||(n="https://aka.ms/l2?WT.mc_id={1}&ep={0}");t=String.format(n,encodeURIComponent(this.h.bH.EncryptedUserPuid),"PROD_OL-Web_InApp_AdBarBlock_Premium")}this.x=String.format(_nbs.a.Hn,t)},bo:function(){this.d(this.j?"AdsUpsellClicked":"AdsAltUpsellClicked",null,null,null,null,null);if(this.s){_a.b.c(_a.a.bJ,"AFP");var t=this.c.D();var n;var r=(n=new _h.cz,n.puid=this.c.c().bH.UserPuid,n.market=_a.bv.a(this.c.bH.AdMarket,t,this.b),n.culture=t,n.correlationId=_a.D.a(),n.merchantId="Microsoft_Office_Upsell",n.displayId=this.b.a().gl().DisplayId,n);var i=_a.b.b(_a.a.bJ,"OnOfficePayAdBarTrigger",!1,null);var u=this;this.C.a(function(n){var t=n.a(r,"AU",null,null,null);n.b(t);_a.b.a(i)})}}};_ab.d=function(n,t,i,r,u,f,e,o,s,h){this.k=n;this.h=t;this.f=i;this.e=r;this.i=u;this.j=f;this.g=e;this.b=o;this.d=s;this.c=h};_ab.d.prototype={k:null,e:null,f:null,i:null,b:null,d:null,j:null,h:null,g:null,c:null,a:function(n){return new _ab.b(this.k,this.h,this.f,this.e,this.i,this.j,n,this.g,this.b,this.d,this.c)}};_ab.c=function(n,t,i){this.j=Function.createDelegate(this,this.o);this.c=Function.createDelegate(this,this.n);this.d=Function.createDelegate(this,this.m);this.e=Function.createDelegate(this,this.p);this.k=Function.createDelegate(this,this.q);this.f=Function.createDelegate(this,this.r);_ab.c.initializeBase(this,[n]);this.b=t;this.h=i};_ab.c.prototype={b:null,h:null,a:null,g:!1,P:function(){_j.c.prototype.P.call(this);this.b.h(this.f);_j.k.b(this.z,"AdCallbackOwa",this.k);_j.k.b(this.z,"AdLoadedCallback",this.e);_j.k.b(this.z,"AdErrorCallback",this.e);_j.k.b(this.z,"AdsThrottle",this.d);_j.k.b(this.z,"AdsYield",this.d)},H:function(){_j.c.prototype.H.call(this);this.a=this.B.a("AdBlockHtmlLabel");this.a&&this.a.fG(this.c);this.i()},bE:function(){this.b&&this.b.j(this.f);this.z&&_j.k.c(this.z,"AdCallbackOwa");this.a&&this.a.kS(this.c);_j.c.prototype.bE.call(this)},n:function(n){for(var i=_j.B.e(n.z.childNodes,"a[target]"),t=0;t<i.length;t++)_j.k.b(i[t],"click",this.j)},o:function(n){var t=new _a.l;t.c("PU",this.h.a().dr().Enabled);t.b("M",_g.a.a().bH.AdMarket||_g.a.a().D().toLowerCase());_a.b.c(_a.a.cZ,"ClickAdBlockFreeLink",t.toString(),0)},r:function(){var n=this.V();n&&n.bj();this.i()},p:function(n){var t=this.V();if(t&&!this.g){this.g=!0;var r=_ff.l.a();var i=Math.floor(_ff.l.c(r,t.y)/500)/2;t.d("AdsFirstLoad",i.toString(),null,null,null,null)}this.m(n)},m:function(n){this.l(n.j(),n)},q:function(n){this.i();var t=n.s;this.l("AdsImpressed",n)},l:function(n,t){var i=t.s;var r=this.V();r&&r.d(n,i.ContextRefreshName,i.UserMarket,i.Provider,i.PageGroup,i.uniqueId)},i:function(){var t="";var n=this.V();if(n&&n.a.B()===2){t=window.innerWidth+"px";if(n.a.d){this.z.style.width=n.a.d.g()+17+"px";this.z.style.height=n.a.d.d()+"px"}}this.X.z.style.width=t}};_ab.a=function(){};_ab.a.$$cctor=function(){_ab.a._I()};_ab.a.e=function(){var n=window.document.createElement("DIV");n.innerHTML="<div> <div class='__Microsoft_Owa_Adsbar_templates_cs_8'> <span class='__Microsoft_Owa_Adsbar_templates_cs_4 ms-fcl-nsa'> </span> <span class='__Microsoft_Owa_Adsbar_templates_cs_5 ms-fwt-r ms-font-color-black'></span> </div> </div><div> <div class='__Microsoft_Owa_Adsbar_templates_cs_2'></div> <a class='__Microsoft_Owa_Adsbar_templates_cs_9 ms-font-color-themePrimary'></a> </div>";_j.i.a().appendChild(n);return n};_ab.a.l=function(n){return n.x};_ab.a.m=function(n){return n.L()};_ab.a.n=function(n){return n.V()};_ab.a.q=function(n){return n.m};_ab.a.t=function(n){return n.Y()};_ab.a.r=function(n){return n.N()};_ab.a.p=function(n){return n.s};_ab.a.s=function(n){return n.X()};_ab.a.o=function(n){return n.W()};_ab.a.h=function(n,t){n.a(t)};_ab.a.u=function(n,t){n.a(t)};_ab.a.i=function(n,t){n.b(t)};_ab.a.k=function(n,t){n.K(t)};_ab.a.j=function(n,t){n.p(t)};_ab.a.f=function(n,t){n.T(t)};_ab.a.g=function(n,t){n.k(t)};_ab.a.d=function(){_ab.a.b||(_ab.a.b=new _fc.k);return _ab.a.b};_ab.a._I=function(){var t="AdsbarPanelView._tid1";new _j.d(t,function(){_ab.a.a[t]===undefined&&(_ab.a.a[t]=[[[-1,4,null,null,null,"Id",null,_ab.a.h,0,null,null,null,_fm.a.bq]],[[-1,0,["AdBlockUseAdFreeMessage"],[_ab.a.l],null,"Html",null,_ab.a.u,1,null,null,null]]]);var n=_ab.a.c.childNodes[0].cloneNode(!0);var i=new _b.p(_j.a.a(n,[0,1]),_j.b.Instance.a(_a.e));var r=new _fc.d(_j.a.a(n,[0,0]),_j.b.Instance.a(_ff.a),_j.b.Instance.a(_ff.b));return new _j.a(n,[r,i]).l({AdBlockHtmlLabel:i})},"",_ab.b,_ab.c,function(n){return new _ab.c(n,_j.b.Instance.a(_y.a),_j.b.Instance.a(_a.e))},!1,!0,!1,0,_ab.a.a);var n="AdsbarPanelView";new _j.d(n,function(){_ab.a.a[n]===undefined&&(_ab.a.a[n]=[[[-1,5,["AdBottom"],[_ab.a.m],null,"__Microsoft_Owa_Adsbar_templates_cs_6",null,null,0,null,null,null],[-1,5,["AdsSmall"],[_ab.a.n],null,"__Microsoft_Owa_Adsbar_templates_cs_7",null,null,0,null,null,null],[-1,5,["ShowAdBlockMessage"],[_ab.a.q],null,"__Microsoft_Owa_Adsbar_templates_cs_3",null,null,0,_ab.a.d(),null,null]],[[-1,0,["UpsellLink"],[_ab.a.t],null,"Href",null,_ab.a.i,1,null,null,null],[-1,0,["ShowUpsell"],[_ab.a.r],null,"IsHidden",null,_ab.a.k,1,_ab.a.d(),null,!0],[-1,0,["PreventNavigation"],[_ab.a.p],null,"PreventNavigation",null,_ab.a.j,1,null,null,!1],[-1,0,["UpsellClickCommand"],[_ab.a.s],null,"ClickCommand",null,_ab.a.f,1,null,null,null],[-1,0,["PremiumUpsellText"],[_ab.a.o],null,"Text",null,_ab.a.g,1,null,null,null]]]);var i=_ab.a.c.childNodes[1].cloneNode(!0);var r=new _fc.e(i.children[1]);r.a("_blank");var t=new _ab.c(i.children[0],_j.b.Instance.a(_y.a),_j.b.Instance.a(_a.e));t.O("owaadbar");t.y("AdsbarPanelView._tid1");return new _j.a(i,[t,r])},"",_ab.b,_ab.c,function(n){return new _ab.c(n,_j.b.Instance.a(_y.a),_j.b.Instance.a(_a.e))},!1,!1,!1,0,_ab.a.a)};AdsbarComponent.registerClass("AdsbarComponent",null,_a.ki,_j.ce);_ab.e.registerClass("_ab.e",_h.fK);_ab.b.registerClass("_ab.b",_a.bw,IAdsbarViewModel,_j.bs,Sys.IDisposable);_ab.c.registerClass("_ab.c",_j.c);AdsbarComponent.$$cctor();_ab.b.b="WAB";_ab.b.a={};_ab.a.c=_ab.a.e();_ab.a.b=null;_ab.a.a={};_ab.a.$$cctor();
window.scriptsLoaded['microsoft.owa.adsbar.js'] = 1; window.scriptProcessEnd = window.scriptProcessEnd || {}; window.scriptProcessEnd['microsoft.owa.adsbar.js'] = (new Date()).getTime();
